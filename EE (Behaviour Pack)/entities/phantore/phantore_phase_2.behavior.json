{
  "format_version": "1.21.70",
  "minecraft:entity": {
    "description": {
      "identifier": "thump989:phantore_phase_2",
      "is_spawnable": true,
      "is_summonable": true,
      "is_experimental": false,
      "runtime_identifier": "minecraft:zombie",
      "properties": {
        "thump989:phantore_spirit_timer": {
          "client_sync": true,
          "default": 0,
          "range": [0, 15],
          "type": "int"
        },
        "thump989:alive": {
          "client_sync": true,
          "default": true,
          "type": "bool"
        },
        "thump989:phantore_power": {
          "client_sync": true,
          "default": 0,
          "range": [0, 30],
          "type": "int"
        },
        "thump989:xp_blast_amount": {
          "client_sync": true,
          "default": 0.0,
          "range": [0.0, 50.0],
          "type": "float"
        },
        "thump989:phantore_attack_state": {
          "client_sync": true,
          "default": "none",
          "type": "enum",
          "values": [
            "none",
            "summon",
            "shadowfire",
            "xp_timer",
            "xp_bomb",
            "skullshot",
            "skullshot_2",
            "recover",
            "melee",
            "homing"
          ]
        }
      },
      "animations": {
        "spirit_timer_tick": "animation.phantore.spirit_timer_tick",
        "homing_attack": "animation.phantore.homing_attack",
        "skullattack_1": "animation.phantore.skullshoot_1",
        "skullattack_2": "animation.phantore.skullshoot_2",
        "xp_siphon": "animation.phantore.xp_siphon",
        "xp_suction": "animation.phantore.xp_suction_phase2",
        "nightlock": "animation.phantore.nightlock",
        "skullshot_controller": "controller.animation.phantore_attacks",
        "homing_controller": "controller.animation.phantore_homing"
      },
      "scripts": {
        "animate": [
          {
            "spirit_timer_tick": "q.property('thump989:alive')==true"
          },
          {
            "nightlock": "q.property('thump989:alive')==true"
          },
          {
            "skullshot_controller": "q.property('thump989:alive')==true"
          },
          {
            "homing_controller": "q.property('thump989:alive')==true"
          },
          {
            "xp_siphon": "q.property('thump989:phantore_attack_state')=='xp_bomb' && q.property('thump989:alive')==true"
          },
          {
            "xp_suction": "q.property('thump989:phantore_attack_state')=='xp_bomb' && q.property('thump989:alive')==true"
          }
        ]
      }
    },
    "components": {
      "minecraft:equipment": {
        "table": "loot_tables/spawn_equipment/faux_armour_10.json",
        "slot_drop_chance": [
          {
            "drop_chance": 0,
            "slot": "slot.armor.chest"
          }
        ]
      },
      "minecraft:tick_world": {
        "never_despawn": true,
        "radius": 2
      },
      "minecraft:dimension_bound": {},
      "minecraft:physics": {
        "has_gravity": true,
        "has_collision": true
      },
      "minecraft:home": {
        "restriction_radius": 30,
        "restriction_type": "all_movement"
      },
      "minecraft:boss": {
        "hud_range": 55,
        "name": "§l§cPhantore",
        "should_darken_sky": true
      },
      "minecraft:health": {
        "value": 3000,
        "max": 3000,
        "min": 1
      },
      "minecraft:environment_sensor": {
        "triggers": [
          {
            "event": "thump989:phantore_phase1_defeat",
            "target": "self",
            "filters": {
              "test": "actor_health",
              "value": 1,
              "subject": "self",
              "operator": "<="
            }
          }
        ]
      },
      "minecraft:type_family": {
        "family": ["mob", "monster", "boss", "undead", "phantore"]
      },
      "minecraft:knockback_resistance": {
        "value": 1,
        "max": 1
      },
      "minecraft:damage_sensor": {
        "triggers": [
          {
            "on_damage": {
              "filters": {
                "test": "is_family",
                "subject": "other",
                "value": "monster"
              }
            },
            "deals_damage": "no"
          }
        ]
      },
      "minecraft:follow_range": {
        "value": 48,
        "max": 48
      },
      "minecraft:pushable": {
        "is_pushable": false
      },
      "minecraft:push_through": {
        "value": 1
      },
      "minecraft:movement": {
        "value": 0.25
      },
      "minecraft:movement.basic": {},
      "minecraft:jump.static": {},
      "minecraft:navigation.walk": {
        "avoid_water": true
      }
    },
    "component_groups": {
      "self:skullcast": {
        "minecraft:knockback_resistance": {
          "value": 1,
          "max": 1
        },
        "minecraft:movement": {
          "value": 0
        },
        "minecraft:timer": {
          "time": 3,
          "looping": true,
          "time_down_event": {
            "event": "thump989:phantore_skullshot_end",
            "target": "self"
          }
        }
      },
      "self:homingshot": {
        "minecraft:knockback_resistance": {
          "value": 1,
          "max": 1
        },
        "minecraft:movement": {
          "value": 0
        },
        "minecraft:timer": {
          "time": 3,
          "looping": true,
          "time_down_event": {
            "event": "thump989:phantore_homingshot_end",
            "target": "self"
          }
        }
      },
      "self:shadowfire_cast": {
        "minecraft:knockback_resistance": {
          "value": 1,
          "max": 1
        },
        "minecraft:timer": {
          "time": 4,
          "looping": true,
          "time_down_event": {
            "event": "thump989:shadowfire_cast_end",
            "target": "self"
          }
        },
        "minecraft:behavior.summon_entity": {
          "summon_choices": [
            {
              "cast_duration": 3,
              "cooldown_time": 1,
              "do_casting": true,
              "max_activation_range": 48,
              "min_activation_range": 1,
              "particle_color": "#9900ff",
              "weight": 1,
              "sequence": [
                {
                  "base_delay": 0.5,
                  "entity_lifespan": 45,
                  "delay_per_summon": 0,
                  "entity_type": "thump989:shadowfire",
                  "shape": "circle",
                  "target": "self",
                  "size": 0,
                  "num_entities_spawned": 1
                },
                {
                  "base_delay": 0.5,
                  "entity_lifespan": 45,
                  "delay_per_summon": 0,
                  "entity_type": "thump989:shadowfire",
                  "shape": "circle",
                  "target": "self",
                  "size": 1,
                  "num_entities_spawned": 4
                },
                {
                  "base_delay": 0.5,
                  "entity_lifespan": 45,
                  "delay_per_summon": 0,
                  "entity_type": "thump989:shadowfire",
                  "shape": "circle",
                  "target": "self",
                  "size": 2,
                  "num_entities_spawned": 6
                }
              ]
            }
          ]
        },
        "minecraft:behavior.nearest_attackable_target": {
          "scan_interval": 10,
          "must_reach": false,
          "entity_types": [
            {
              "max_dist": 32,
              "filters": [
                {
                  "any_of": [
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "player"
                    },
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "wolf"
                    },
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "irongolem"
                    }
                  ]
                }
              ]
            }
          ]
        }
      },
      "self:skeleton_cast": {
        "minecraft:timer": {
          "time": 5,
          "looping": true,
          "time_down_event": {
            "event": "thump989:phantore_skeleton_cast_end",
            "target": "self"
          }
        },
        "minecraft:behavior.summon_entity": {
          "summon_choices": [
            {
              "cast_duration": 4,
              "cooldown_time": 1,
              "do_casting": true,
              "max_activation_range": 48,
              "min_activation_range": 1,
              "particle_color": "#00e1ff",
              "weight": 1,
              "sequence": [
                {
                  "base_delay": 3,
                  "entity_lifespan": -1,
                  "delay_per_summon": 0,
                  "entity_type": "minecraft:lightning_bolt",
                  "shape": "circle",
                  "target": "self",
                  "size": 4,
                  "num_entities_spawned": 4
                },
                {
                  "base_delay": 0.05,
                  "entity_lifespan": -1,
                  "delay_per_summon": 0,
                  "entity_type": "thump989:elite_skeleton",
                  "shape": "circle",
                  "target": "self",
                  "size": 4,
                  "num_entities_spawned": 4
                }
              ]
            }
          ]
        },
        "minecraft:behavior.nearest_attackable_target": {
          "scan_interval": 10,
          "must_reach": false,
          "entity_types": [
            {
              "max_dist": 32,
              "filters": [
                {
                  "any_of": [
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "player"
                    },
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "wolf"
                    },
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "irongolem"
                    }
                  ]
                }
              ]
            }
          ]
        }
      },
      "self:melee_mode": {
        "minecraft:timer": {
          "time": 5,
          "looping": true,
          "time_down_event": {
            "event": "thump989:phantore_melee_mode_end",
            "target": "self"
          }
        },
        "minecraft:behavior.summon_entity": {
          "summon_choices": [
            {
              "cast_duration": 5,
              "cooldown_time": 1.1,
              "do_casting": true,
              "max_activation_range": 48,
              "min_activation_range": 1,
              "particle_color": "#ff00bf",
              "weight": 1,
              "sequence": [
                {
                  "base_delay": 3,
                  "entity_lifespan": -1,
                  "delay_per_summon": 0,
                  "entity_type": "thump989:phantore_spirit",
                  "summon_event": "thump989:phantore_melee_mode",
                  "shape": "line",
                  "target": "self",
                  "size": 2,
                  "num_entities_spawned": 1
                }
              ]
            }
          ]
        },
        "minecraft:behavior.nearest_attackable_target": {
          "scan_interval": 10,
          "must_reach": false,
          "entity_types": [
            {
              "max_dist": 32,
              "filters": [
                {
                  "any_of": [
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "player"
                    },
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "wolf"
                    },
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "irongolem"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "minecraft:knockback_resistance": {
          "value": 1,
          "max": 1
        }
      },
      "self:roar": {
        "minecraft:movement": {
          "value": 0.25
        },
        "minecraft:knockback_resistance": {
          "value": 1,
          "max": 1
        },
        "minecraft:behavior.knockback_roar": {
          "attack_time": 0.95,
          "knockback_height_cap": 0.4,
          "priority": 0,
          "cooldown_time": 2,
          "duration": 3,
          "knockback_damage": 15,
          "knockback_horizontal_strength": 2,
          "knockback_range": 4,
          "on_roar_end": {
            "event": "thump989:phantore_roar_end",
            "target": "self"
          },
          "knockback_vertical_strength": 2,
          "damage_filters": [
            {
              "any_of": [
                {
                  "test": "is_family",
                  "subject": "other",
                  "value": "player"
                },
                {
                  "test": "is_family",
                  "subject": "other",
                  "value": "irongolem"
                },
                {
                  "test": "is_family",
                  "subject": "other",
                  "value": "wolf"
                }
              ]
            }
          ],
          "knockback_filters": [
            {
              "any_of": [
                {
                  "test": "is_family",
                  "subject": "other",
                  "value": "player"
                },
                {
                  "test": "is_family",
                  "subject": "other",
                  "value": "irongolem"
                },
                {
                  "test": "is_family",
                  "subject": "other",
                  "value": "wolf"
                }
              ]
            }
          ]
        }
      },
      "self:xp_bomb_timer": {
        "minecraft:knockback_resistance": {
          "value": 1,
          "max": 1
        },
        "minecraft:timer": {
          "time": 2,
          "looping": true,
          "time_down_event": {
            "event": "thump989:phantore_xp_bomb",
            "target": "self"
          }
        }
      },
      "self:xp_bomb": {
        "minecraft:knockback_resistance": {
          "value": 1,
          "max": 1
        },
        "minecraft:timer": {
          "time": 11.75,
          "looping": true,
          "time_down_event": {
            "event": "thump989:xp_bomb_detonate",
            "target": "self"
          }
        }
      },
      "self:xp_bomb_recover": {
        "minecraft:behavior.nearest_attackable_target": {
          "scan_interval": 10,
          "must_reach": false,
          "entity_types": [
            {
              "max_dist": 32,
              "filters": [
                {
                  "any_of": [
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "player"
                    },
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "wolf"
                    },
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "irongolem"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "minecraft:behavior.melee_attack": {
          "speed_multiplier": 0,
          "cooldown_time": 1,
          "reach_multiplier": 0
        },
        "minecraft:knockback_resistance": {
          "value": 1,
          "max": 1
        },
        "minecraft:attack": {
          "damage": 1
        },
        "minecraft:timer": {
          "time": 5,
          "looping": true,
          "time_down_event": {
            "event": "thump989:phantore_attack_select",
            "target": "self"
          }
        }
      },
      "self:attack_prepare": {
        "minecraft:knockback_resistance": {
          "value": 1,
          "max": 1
        },
        "minecraft:behavior.nearest_attackable_target": {
          "scan_interval": 10,
          "must_reach": false,
          "entity_types": [
            {
              "max_dist": 32,
              "filters": [
                {
                  "any_of": [
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "player"
                    },
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "wolf"
                    },
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "irongolem"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "minecraft:behavior.melee_attack": {
          "speed_multiplier": 0,
          "cooldown_time": 1,
          "reach_multiplier": 0
        },
        "minecraft:attack": {
          "damage": 1
        },
        "minecraft:timer": {
          "time": 1,
          "looping": true,
          "time_down_event": {
            "event": "thump989:phantore_attack_select",
            "target": "self"
          }
        }
      },
      "self:transform": {
        "minecraft:transformation": {
          "begin_transform_sound": "example",
          "drop_equipment": false,
          "drop_inventory": false,
          "transformation_sound": "cast.spell",
          "into": "thump989:phantore_phase_3",
          "keep_level": false,
          "keep_owner": false,
          "delay": 4
        }
      },
      "self:defeated": {
        "minecraft:transformation": {
          "begin_transform_sound": "example",
          "drop_equipment": false,
          "drop_inventory": false,
          "transformation_sound": "cast.spell",
          "into": "thump989:phantore_phase_3",
          "keep_level": false,
          "keep_owner": false,
          "delay": 4
        },
        "minecraft:timer": {
          "time": 30,
          "looping": true,
          "time_down_event": {
            "event": "thump989:begin_transform",
            "target": "self"
          }
        },
        "minecraft:mob_effect_immunity": {
          "mob_effects": [
            "absorption",
            "bad_omen",
            "blindness",
            "conduit_power",
            "darkness",
            "fatal_poison",
            "fire_resistance",
            "haste",
            "health_boost",
            "hunger",
            "infested",
            "instant_damage",
            "instant_health",
            "invisibility",
            "jump_boost",
            "levitation",
            "mining_fatigue",
            "nausea",
            "night_vision",
            "oozing",
            "poison",
            "raid_omen",
            "regeneration",
            "resistance",
            "saturation",
            "slow_falling",
            "slowness",
            "speed",
            "strength",
            "trial_omen",
            "village_hero",
            "water_breathing",
            "weakness",
            "weaving",
            "wind_charged",
            "wither"
          ]
        },
        "minecraft:environment_sensor": {},
        "minecraft:damage_sensor": {
          "triggers": [
            {
              "cause": "all",
              "deals_damage": "no"
            }
          ]
        },
        "minecraft:boss": {
          "hud_range": 0,
          "name": "a",
          "should_darken_sky": false
        },
        "minecraft:movement": {
          "value": 0.15
        }
      },
      "self:instant_despawn": {
        "minecraft:instant_despawn": {
          "remove_child_entities": false
        }
      }
    },
    "events": {
      "thump989:phantore_phase1_defeat": {
        "queue_command": {
          "command": ["kill @e[type=thump989:phantore_spirit]"]
        },
        "set_property": {
          "thump989:alive": false
        },
        "remove": {
          "component_groups": [
            "self:skullcast",
            "self:attack_prepare",
            "self:shadowfire_cast",
            "self:skeleton_cast",
            "self:melee_mode",
            "self:xp_bomb_timer",
            "self:xp_bomb",
            "self:xp_bomb_recover"
          ]
        },
        "add": {
          "component_groups": ["self:defeated"]
        }
      },
      "thump989:phantore_skullhot_start": {
        "set_property": {
          "thump989:phantore_attack_state": "math.random_integer(0,1)==1 ? 'skullshot' : 'skullshot_2'"
        },
        "add": {
          "component_groups": ["self:skullcast"]
        }
      },
      "thump989:phantore_skullshot_end": {
        "set_property": {
          "thump989:phantore_attack_state": "none",
          "thump989:phantore_power": "q.property('thump989:phantore_power')+1"
        },
        "remove": {
          "component_groups": ["self:skullcast"]
        },
        "add": {
          "component_groups": ["self:attack_prepare"]
        }
      },
      "thump989:shadowfire_cast_end": {
        "remove": {
          "component_groups": ["self:shadowfire_cast"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "none",
          "thump989:phantore_power": "q.property('thump989:phantore_power')+2"
        },
        "add": {
          "component_groups": ["self:attack_prepare"]
        }
      },
      "thump989:phantore_shadowfire_cast": {
        "reset_target": {},
        "add": {
          "component_groups": ["self:shadowfire_cast"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "shadowfire"
        }
      },
      "thump989:phantore_skeleton_cast": {
        "reset_target": {},
        "add": {
          "component_groups": ["self:skeleton_cast"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "summon"
        }
      },
      "thump989:phantore_skeleton_cast_end": {
        "reset_target": {},
        "remove": {
          "component_groups": ["self:skeleton_cast"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "none",
          "thump989:phantore_power": 0
        },
        "add": {
          "component_groups": ["self:attack_prepare"]
        }
      },
      "thump989:phantore_melee_mode": {
        "add": {
          "component_groups": ["self:melee_mode"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "summon",
          "thump989:phantore_spirit_timer": 15
        }
      },
      "thump989:phantore_melee_mode_end": {
        "remove": {
          "component_groups": ["self:melee_mode"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "none",
          "thump989:phantore_power": "q.property('thump989:phantore_power')+3"
        },
        "add": {
          "component_groups": ["self:attack_prepare"]
        }
      },
      "thump989:phantore_homingshot": {
        "add": {
          "component_groups": ["self:homingshot"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "homing"
        }
      },
      "thump989:phantore_homingshot_end": {
        "remove": {
          "component_groups": ["self:homingshot"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "none",
          "thump989:phantore_power": "q.property('thump989:phantore_power')+1"
        },
        "add": {
          "component_groups": ["self:attack_prepare"]
        }
      },
      "thump989:phantore_roar": {
        "add": {
          "component_groups": ["self:roar"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "none"
        }
      },
      "thump989:phantore_roar_end": {
        "remove": {
          "component_groups": ["self:roar"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "none",
          "thump989:phantore_power": "q.property('thump989:phantore_power')+2"
        },
        "add": {
          "component_groups": ["self:attack_prepare"]
        }
      },
      "thump989:phantore_xp_bomb_timer": {
        "add": {
          "component_groups": ["self:xp_bomb_timer"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "xp_timer",
          "thump989:xp_blast_amount": 0.0
        },
        "queue_command": {
          "command": ["playsound mob.phantore.exp_absorb_start @a ~ ~ ~"]
        }
      },
      "thump989:phantore_xp_bomb": {
        "set_property": {
          "thump989:phantore_attack_state": "xp_bomb"
        },
        "remove": {
          "component_groups": ["self:xp_bomb_timer"]
        },
        "add": {
          "component_groups": ["self:xp_bomb"]
        }
      },
      "thump989:xp_bomb_detonate": {
        "remove": {
          "component_groups": ["self:xp_bomb"]
        },
        "add": {
          "component_groups": ["self:xp_bomb_recover"]
        },
        "set_property": {
          "thump989:xp_blast_amount": 0.0,
          "thump989:phantore_attack_state": "recover",
          "thump989:phantore_power": 0
        },
        "queue_command": {
          "command": [
            "scriptevent thump989:phantore_xp_explosion xp_explosion",
            "playsound mob.phantore.exp_absorb_start @a ~ ~ ~"
          ]
        }
      },
      "thump989:phantore_attack_select": {
        "sequence": [
          {
            "set_property": {
              "thump989:phantore_attack_state": "none"
            },
            "remove": {
              "component_groups": ["self:attack_prepare"]
            }
          },
          {
            "first_valid": [
              {
                "filters": [
                  {
                    "test": "has_target",
                    "subject": "self",
                    "operator": "not"
                  }
                ],
                "add": {
                  "component_groups": ["self:attack_prepare"]
                }
              },
              {
                "filters": [
                  {
                    "test": "int_property",
                    "value": 10,
                    "domain": "thump989:phantore_power",
                    "operator": "<="
                  }
                ],
                "randomize": [
                  {
                    "trigger": "thump989:phantore_skullhot_start",
                    "weight": 2
                  },
                  {
                    "filters": [
                      {
                        "test": "int_property",
                        "value": 0,
                        "operator": "==",
                        "domain": "thump989:phantore_spirit_timer"
                      }
                    ],
                    "trigger": "thump989:phantore_melee_mode",
                    "weight": 1
                  },
                  {
                    "trigger": "thump989:phantore_homingshot",
                    "weight": 1
                  }
                ]
              },
              {
                "filters": [
                  {
                    "test": "int_property",
                    "value": 10,
                    "domain": "thump989:phantore_power",
                    "operator": ">"
                  }
                ],
                "randomize": [
                  {
                    "trigger": "thump989:phantore_skeleton_cast",
                    "weight": 1
                  },
                  {
                    "trigger": "thump989:phantore_xp_bomb_timer",
                    "weight": 1
                  }
                ]
              }
            ]
          }
        ]
      },
      "minecraft:entity_spawned": {
        "add": {
          "component_groups": ["self:attack_prepare"]
        },
        "queue_command": {
          "command": ["weather thunder"]
        }
      },
      "thump989:instant_despawn": {
        "add": {
          "component_groups": ["self:instant_despawn"]
        }
      },
      "thump989:begin_transform": {
        "add": {
          "component_groups": ["self:transform"]
        }
      },
      "thump989:spirit_timer_tick": {
        "set_property": {
          "thump989:phantore_spirit_timer": "q.property('thump989:phantore_spirit_timer')-1"
        }
      },
      "minecraft:entity_transformed": {
        "set_home_position": {},
        "add": {
          "component_groups": ["self:attack_prepare"]
        },
        "queue_command": {
          "command": [
            "particle minecraft:huge_explosion_emitter",
            "playsound random.explode @a ~ ~ ~ 4",
            "weather thunder"
          ]
        }
      }
    }
  }
}
