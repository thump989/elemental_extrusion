{
  "format_version": "1.21.70",
  "minecraft:entity": {
    "description": {
      "identifier": "thump989:phantore_spirit",
      "is_spawnable": false,
      "is_summonable": true,
      "is_experimental": false,
      "runtime_identifier": "minecraft:zombie",
      "properties": {
        "thump989:alive": {
          "client_sync": true,
          "default": true,
          "type": "bool"
        },
        "thump989:phantore_power": {
          "client_sync": true,
          "default": 0,
          "range": [0, 30],
          "type": "int"
        },
        "thump989:xp_blast_amount": {
          "client_sync": true,
          "default": 0.0,
          "range": [0.0, 50.0],
          "type": "float"
        },
        "thump989:phantore_attack_state": {
          "client_sync": true,
          "default": "none",
          "type": "enum",
          "values": [
            "none",
            "summon",
            "shadowfire",
            "xp_timer",
            "xp_bomb",
            "skullshot",
            "skullshot_2",
            "recover",
            "melee",
            "homing"
          ]
        }
      },
      "animations": {
        "homing_attack": "animation.phantore.homing_attack",
        "skullattack_1": "animation.phantore.skullshoot_1",
        "skullattack_2": "animation.phantore.skullshoot_2",
        "xp_siphon": "animation.phantore.xp_siphon",
        "xp_suction": "animation.phantore.xp_suction_phase2",
        "nightlock": "animation.phantore.nightlock",
        "skullshot_controller": "controller.animation.phantore_attacks",
        "homing_controller": "controller.animation.phantore_homing"
      },
      "scripts": {
        "animate": [
          {
            "skullshot_controller": "q.property('thump989:alive')==true"
          },
          {
            "homing_controller": "q.property('thump989:alive')==true"
          }
        ]
      }
    },
    "components": {
      "minecraft:equipment": {
        "table": "loot_tables/spawn_equipment/faux_armour_10.json",
        "slot_drop_chance": [
          {
            "drop_chance": 0,
            "slot": "slot.armor.chest"
          }
        ]
      },
      "minecraft:experience_reward": {
        "on_bred": 0,
        "on_death": 100
      },
      "minecraft:mob_effect": {
        "cooldown_time": 1,
        "effect_time": 1,
        "effect_range": 50,
        "mob_effect": "resistance",
        "entity_filter": [
          {
            "test": "is_family",
            "value": "phantore",
            "subject": "other"
          }
        ]
      },
      "minecraft:dimension_bound": {},
      "minecraft:physics": {
        "has_gravity": true,
        "has_collision": true
      },
      "minecraft:health": {
        "value": 200,
        "max": 200
      },
      "minecraft:type_family": {
        "family": ["mob", "monster", "boss", "undead"]
      },
      "minecraft:knockback_resistance": {
        "value": 0.75,
        "max": 0.75
      },
      "minecraft:damage_sensor": {
        "triggers": [
          {
            "on_damage": {
              "filters": {
                "test": "is_family",
                "subject": "other",
                "value": "monster"
              }
            },
            "deals_damage": "no"
          }
        ]
      },
      "minecraft:follow_range": {
        "value": 48,
        "max": 48
      },
      "minecraft:pushable": {
        "is_pushable": false
      },
      "minecraft:push_through": {
        "value": 1
      },
      "minecraft:movement": {
        "value": 0.25
      },
      "minecraft:movement.basic": {},
      "minecraft:jump.static": {},
      "minecraft:navigation.walk": {
        "avoid_water": true
      }
    },
    "component_groups": {
      "self:skullcast": {
        "minecraft:knockback_resistance": {
          "value": 1,
          "max": 1
        },
        "minecraft:movement": {
          "value": 0
        },
        "minecraft:timer": {
          "time": 3,
          "looping": true,
          "time_down_event": {
            "event": "thump989:phantore_skullshot_end",
            "target": "self"
          }
        }
      },
      "self:homingshot": {
        "minecraft:knockback_resistance": {
          "value": 1,
          "max": 1
        },
        "minecraft:movement": {
          "value": 0
        },
        "minecraft:timer": {
          "time": 3,
          "looping": true,
          "time_down_event": {
            "event": "thump989:phantore_homingshot_end",
            "target": "self"
          }
        }
      },
      "self:shadowfire_cast": {
        "minecraft:knockback_resistance": {
          "value": 1,
          "max": 1
        },
        "minecraft:timer": {
          "time": 4,
          "looping": true,
          "time_down_event": {
            "event": "thump989:shadowfire_cast_end",
            "target": "self"
          }
        },
        "minecraft:behavior.summon_entity": {
          "summon_choices": [
            {
              "cast_duration": 3,
              "cooldown_time": 1,
              "do_casting": true,
              "max_activation_range": 48,
              "min_activation_range": 1,
              "particle_color": "#9900ff",
              "weight": 1,
              "sequence": [
                {
                  "base_delay": 0.5,
                  "entity_lifespan": 45,
                  "delay_per_summon": 0,
                  "entity_type": "thump989:shadowfire",
                  "shape": "circle",
                  "target": "self",
                  "size": 0,
                  "num_entities_spawned": 1
                },
                {
                  "base_delay": 0.5,
                  "entity_lifespan": 45,
                  "delay_per_summon": 0,
                  "entity_type": "thump989:shadowfire",
                  "shape": "circle",
                  "target": "self",
                  "size": 1,
                  "num_entities_spawned": 4
                },
                {
                  "base_delay": 0.5,
                  "entity_lifespan": 45,
                  "delay_per_summon": 0,
                  "entity_type": "thump989:shadowfire",
                  "shape": "circle",
                  "target": "self",
                  "size": 2,
                  "num_entities_spawned": 6
                }
              ]
            }
          ]
        },
        "minecraft:behavior.nearest_attackable_target": {
          "scan_interval": 10,
          "must_reach": false,
          "entity_types": [
            {
              "max_dist": 32,
              "filters": [
                {
                  "any_of": [
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "player"
                    },
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "wolf"
                    },
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "irongolem"
                    }
                  ]
                }
              ]
            }
          ]
        }
      },
      "self:melee_mode": {
        "minecraft:timer": {
          "time": 15,
          "looping": true,
          "time_down_event": {
            "event": "thump989:phantore_melee_mode_end",
            "target": "self"
          }
        },
        "minecraft:behavior.melee_attack": {
          "melee_fov": 90,
          "track_target": false,
          "attack_types": "example",
          "random_stop_interval": 0,
          "reach_multiplier": 2,
          "can_spread_on_fire": true,
          "speed_multiplier": 1.25,
          "cooldown_time": 1
        },
        "minecraft:movement": {
          "value": 0.25
        },
        "minecraft:attack": {
          "damage": 15,
          "effect_name": "trial_omen",
          "effect_duration": "infinite"
        },
        "minecraft:knockback_resistance": {
          "value": 0.8,
          "max": 0.8
        },
        "minecraft:behavior.nearest_attackable_target": {
          "scan_interval": 10,
          "must_reach": false,
          "entity_types": [
            {
              "max_dist": 32,
              "filters": [
                {
                  "any_of": [
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "player"
                    },
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "wolf"
                    },
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "irongolem"
                    }
                  ]
                }
              ]
            }
          ]
        }
      },
      "self:roar": {
        "minecraft:movement": {
          "value": 0.25
        },
        "minecraft:knockback_resistance": {
          "value": 1,
          "max": 1
        },
        "minecraft:behavior.knockback_roar": {
          "attack_time": 0.95,
          "knockback_height_cap": 0.4,
          "priority": 0,
          "cooldown_time": 2,
          "duration": 3,
          "knockback_damage": 15,
          "knockback_horizontal_strength": 2,
          "knockback_range": 4,
          "on_roar_end": {
            "event": "thump989:phantore_roar_end",
            "target": "self"
          },
          "knockback_vertical_strength": 2,
          "damage_filters": [
            {
              "any_of": [
                {
                  "test": "is_family",
                  "subject": "other",
                  "value": "player"
                },
                {
                  "test": "is_family",
                  "subject": "other",
                  "value": "irongolem"
                },
                {
                  "test": "is_family",
                  "subject": "other",
                  "value": "wolf"
                }
              ]
            }
          ],
          "knockback_filters": [
            {
              "any_of": [
                {
                  "test": "is_family",
                  "subject": "other",
                  "value": "player"
                },
                {
                  "test": "is_family",
                  "subject": "other",
                  "value": "irongolem"
                },
                {
                  "test": "is_family",
                  "subject": "other",
                  "value": "wolf"
                }
              ]
            }
          ]
        }
      },
      "self:attack_prepare": {
        "minecraft:knockback_resistance": {
          "value": 1,
          "max": 1
        },
        "minecraft:behavior.nearest_attackable_target": {
          "scan_interval": 10,
          "must_reach": false,
          "entity_types": [
            {
              "max_dist": 32,
              "filters": [
                {
                  "any_of": [
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "player"
                    },
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "wolf"
                    },
                    {
                      "test": "is_family",
                      "subject": "other",
                      "value": "irongolem"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "minecraft:behavior.melee_attack": {
          "speed_multiplier": 0,
          "cooldown_time": 1,
          "reach_multiplier": 0
        },
        "minecraft:attack": {
          "damage": 1
        },
        "minecraft:timer": {
          "time": 1,
          "looping": true,
          "time_down_event": {
            "event": "thump989:phantore_attack_select",
            "target": "self"
          }
        }
      },
      "self:instant_despawn": {
        "minecraft:instant_despawn": {
          "remove_child_entities": false
        }
      }
    },
    "events": {
      "thump989:phantore_skullhot_start": {
        "set_property": {
          "thump989:phantore_attack_state": "math.random_integer(0,1)==1 ? 'skullshot' : 'skullshot_2'"
        },
        "add": {
          "component_groups": ["self:skullcast"]
        }
      },
      "thump989:phantore_skullshot_end": {
        "set_property": {
          "thump989:phantore_attack_state": "none",
          "thump989:phantore_power": "q.property('thump989:phantore_power')+1"
        },
        "remove": {
          "component_groups": ["self:skullcast"]
        },
        "add": {
          "component_groups": ["self:attack_prepare"]
        }
      },
      "thump989:shadowfire_cast_end": {
        "remove": {
          "component_groups": ["self:shadowfire_cast"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "none",
          "thump989:phantore_power": "q.property('thump989:phantore_power')+2"
        },
        "add": {
          "component_groups": ["self:attack_prepare"]
        }
      },
      "thump989:phantore_shadowfire_cast": {
        "reset_target": {},
        "add": {
          "component_groups": ["self:shadowfire_cast"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "shadowfire"
        }
      },
      "thump989:phantore_melee_mode": {
        "add": {
          "component_groups": ["self:melee_mode"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "melee"
        }
      },
      "thump989:phantore_melee_mode_end": {
        "remove": {
          "component_groups": ["self:melee_mode"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "none",
          "thump989:phantore_power": "q.property('thump989:phantore_power')+3"
        },
        "add": {
          "component_groups": ["self:attack_prepare"]
        }
      },
      "thump989:phantore_homingshot": {
        "add": {
          "component_groups": ["self:homingshot"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "homing"
        }
      },
      "thump989:phantore_homingshot_end": {
        "remove": {
          "component_groups": ["self:homingshot"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "none",
          "thump989:phantore_power": "q.property('thump989:phantore_power')+1"
        },
        "add": {
          "component_groups": ["self:attack_prepare"]
        }
      },
      "thump989:phantore_roar": {
        "add": {
          "component_groups": ["self:roar"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "none"
        }
      },
      "thump989:phantore_roar_end": {
        "remove": {
          "component_groups": ["self:roar"]
        },
        "set_property": {
          "thump989:phantore_attack_state": "none",
          "thump989:phantore_power": "q.property('thump989:phantore_power')+2"
        },
        "add": {
          "component_groups": ["self:attack_prepare"]
        }
      },
      "thump989:phantore_attack_select": {
        "sequence": [
          {
            "set_property": {
              "thump989:phantore_attack_state": "none"
            },
            "remove": {
              "component_groups": ["self:attack_prepare"]
            }
          },
          {
            "first_valid": [
              {
                "filters": [
                  {
                    "test": "has_target",
                    "subject": "self",
                    "operator": "not"
                  }
                ],
                "add": {
                  "component_groups": ["self:attack_prepare"]
                }
              },
              {
                "randomize": [
                  {
                    "trigger": "thump989:phantore_skullhot_start",
                    "weight": 2
                  },
                  {
                    "trigger": "thump989:phantore_melee_mode",
                    "weight": 1
                  },
                  {
                    "trigger": "thump989:phantore_homingshot",
                    "weight": 1
                  },
                  {
                    "filters": [
                      {
                        "test": "target_distance",
                        "value": 6,
                        "operator": "<="
                      }
                    ],
                    "trigger": "thump989:phantore_roar",
                    "weight": 1
                  },
                  {
                    "filters": [
                      {
                        "test": "target_distance",
                        "value": 6,
                        "operator": "<="
                      }
                    ],
                    "trigger": "thump989:phantore_shadowfire_cast",
                    "weight": 1
                  }
                ]
              }
            ]
          }
        ]
      },
      "minecraft:entity_spawned": {
        "add": {
          "component_groups": ["self:attack_prepare"]
        }
      },
      "thump989:instant_despawn": {
        "add": {
          "component_groups": ["self:instant_despawn"]
        }
      },
      "thump989:begin_transform": {
        "add": {
          "component_groups": ["self:transform"]
        }
      },
      "minecraft:entity_transformed": {
        "set_home_position": {},
        "add": {
          "component_groups": ["self:attack_prepare"]
        },
        "queue_command": {
          "command": [
            "particle minecraft:huge_explosion_emitter",
            "playsound random.explode @a ~ ~ ~ 4",
            "weather thunder"
          ]
        }
      }
    }
  }
}
